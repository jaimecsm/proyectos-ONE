<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Encriptador</title>
    <link rel="stylesheet" href="style.css">
</head>

<body class="principal">
    <header class="titulo-header">
        <img src="imagenes/encriptador.jfif" alt="logo referencia a encriptacion">
        <h1>Encriptador de Texto</h1>
    </header>
    <main>
        <div>
            <h2 class="encdes">Encriptar/Desencriptar</h2>
            <h2 class="enc">Resultado</h2>
            <textarea cols="70" rows="10" id="texto" placeholder="Ingrese el texto aquí" autofocus></textarea>
            <textarea cols="70" rows="10" id="resultado" readonly></textarea>
        </div>

        <input type="submit" value="Encriptar" class="encriptar" id="Encriptar">
        <input type="submit" value="Desencriptar" class="desencriptar" id="Desencriptar">
        <input type="submit" value="limpiar" class="limpiar" id="Limpiar">
        <input type="submit" value="copiar" class="copiar" id="Copiar">

    </main>
    <footer>
        <img src="imagenes/jaime.png" alt="Jaime Contreras San Martín">
        <p class="derecho-autor">&copy Copyright Jaime Contreras San Martín</p>
    </footer>
</body>

<script>    

    function encriptar(){

        var narrativa = document.getElementById("texto").value;
        var encriptado = "";
        var llaves = ["enter","imes","ai","ober","ufat"];

        if (narrativa == "") {
            alert("Debe ingresar un texto");
        }else if(document.getElementById("texto").value == document.getElementById("resultado").value){
            alert("Ingrese un texto distinto al del resultado")
        }else{
                for(var i=0; i < narrativa.length; i++){
                switch (narrativa[i]){
                    case "e":
                        encriptado = encriptado + "enter";
                        break;
                    case "i": 
                        encriptado = encriptado + "imes";
                        break;
                    case "a":
                        encriptado = encriptado + "ai";
                        break;
                    case "o": 
                        encriptado = encriptado + "ober";
                        break;
                    case "u": 
                        encriptado = encriptado + "ufat";
                        break;
                    default:
                        encriptado = encriptado + narrativa[i];
                        break;
                        }
                }
         }
        document.getElementById("resultado").value = encriptado;
        mostrar();
        }

    function desencriptar(){

        var narrativa2 = document.getElementById("resultado").value;
        var narrativa1 = document.getElementById("texto").value;
        var llave1 = ["enter","imes","ai","ober","ufat"];
        var llave2 = ["e","i","a","o","u"];
      
        if (narrativa2 == "") {
            alert("Debe haber un texto encriptado para esta acción");
        }else if(narrativa1.length != narrativa2.length){
            alert("debe copiar el texto encriptado del cuadro que esta a su derecha");
        }else{
            for(var i = 0; i < 5; i++){
                //encuentra la primera posición de la llave
                var posicion = narrativa2.indexOf(llave1[i]);
                //console.log(posicion);
                var text = llave1[i];
                //y mientras tenga una posición mayor o igual a 0
                //-1 significa que no lo encontro
                while(posicion >= 0){
                    //reemplaza "enter" por "e"
                    narrativa2 = narrativa2.slice(0,posicion) + llave2[i] + narrativa2.slice(posicion + text.length);
                    console.log(narrativa2);
                    //busca la siguiente ocurrencia de la palabra
                    posicion = narrativa2.indexOf(llave1[i]);
                }
            }           
        }
        document.getElementById("resultado").value = narrativa2;
      }  
    

    function mostrar(){
        document.getElementById("Copiar").style.display = "inline";
    }

    function ocultar(){
        document.getElementById("Copiar").style.display = "none";
    }
    
    function limpiar(){
        document.getElementById("texto").value = "";
        document.getElementById("resultado").value = "";
        ocultar();
        document.getElementById("texto").focus();
    }

    function copiar(){
        document.getElementById("texto").value = "";
        var aux = document.createElement("input");
        aux.setAttribute("value", document.getElementById("resultado").value);
        document.body.appendChild(aux);
        aux.select();
        document.execCommand("copy");
        document.body.removeChild(aux);
    }

   

    var botonEnc = document.getElementById("Encriptar");
    botonEnc.onclick = encriptar;
  
    var botonDesc = document.getElementById("Desencriptar");
    botonDesc.onclick = desencriptar;
    
    var botonLimpiar = document.getElementById("Limpiar");
    botonLimpiar.onclick = limpiar;

    var botonCopiar = document.getElementById("Copiar");
    botonCopiar.onclick = copiar;
    
</script>
</html>